<!DOCTYPE html>
<html lang="en-US">
    <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Tom Leverstone">
<meta name="description" content="A father, software engineer, and hobbies collector.">
<title>Tom Leverstone</title>
<!-- Favicon -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- Bootstrap Core CSS -->
<link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css">
<!-- Custom Fonts -->
<link rel="stylesheet" href="/theme/font-awesome/css/all.css" type="text/css">
<!-- Plugin CSS -->
<link rel="stylesheet" href="/theme/css/youtube.css" type="text/css">
<!-- Custom CSS -->
<link rel="stylesheet" href="/theme/css/creative.css" type="text/css">

<!-- Open graph protocol -->
<meta property="og:title" content="Tom Leverstone" />
<meta property="og:type" content="website" />
<meta property="og:url" content="" />
<meta property="og:image:secure_url" itemprop="image" content="/images/me.jpg" />
<meta property="og:description" content="A father, software engineer, and hobbies collector." />

<!-- Twitter cards -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="/images/me.jpg" />    </head>
    <body>
<div class="container article-container">
<nav>
  <a class="btn" href="/" aria-label="Home">
    <span class="fas fa-home"></span>
  </a>
  <ul class="float">
    <li>
      <a class="btn " href="/blog/">
        Blog
      </a>
    </li>
    <li>
      <a class="btn " href="/projects/">
        Projects
      </a>
    </li>
    <li>
      <a class="btn " href="/hobbies/">
        Hobbies
      </a>
    </li>
  </ul>
</nav>    <h1 class="title">LLM synthetic data in bash</h1>
        <time datetime="2024-05-23">
            May 23, 2024
        </time>
    <div class="content">
        <p>The <a href="https://github.com/simonw/llm"><code>llm</code> command line tool by Simon Willison</a> lets you interact with LLMs from the command line. I've been using it recently, and while it's nice and convenient, I wasn't doing anythin I couldn't do with a "vanila" LLM ChatBot a la ChatGPT. Until today!</p>
<p>Today, I had to test our retrieval-augmented generation (RAG) system. I wanted to hit a endpoint repeatedly and monitor the response time while running some operations on the server. Sure, I can throw something together with a bash loop and <code>curl</code>. But what if my experiment will be skewed by caching somewhere in the system if the request is always the same ðŸ¤”</p>
<p>Here's what I ended up with</p>
<div class="highlight"><pre><span></span><code><span class="k">while</span><span class="w"> </span><span class="nb">true</span>
<span class="k">do</span>
<span class="w">  </span>curl<span class="w"> </span>https://my-server.com/<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-d<span class="w"> </span><span class="s2">&quot;{\&quot;query\&quot;: \&quot;`llm &quot;</span>Give<span class="w"> </span>me<span class="w"> </span>a<span class="w"> </span>one<span class="w"> </span>sentence<span class="w"> </span>interesting<span class="w"> </span>question<span class="w"> </span>about<span class="w"> </span>consumers<span class="w"> </span>behaviours<span class="s2">&quot;`\&quot;}&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--output<span class="w"> </span>/dev/null<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--silent<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--write-out<span class="w"> </span><span class="s2">&quot;%{http_code} %{time_total}s\n&quot;</span>
<span class="k">done</span>
</code></pre></div>

<p>It hits the system with a new query every time, running in an endless loop.</p>
<ul>
<li><code>--output /dev/null</code> is there to discard the response from the server. I'm not really interested in that.</li>
<li><code>--silent</code> is there to discard any output from <code>curl</code> itself.</li>
<li><code>--write-out "%{http_code} %{time_total}s\n"</code> is to get the debugging output I'm interested in: status code and the time it took the server to respond, in seconds.</li>
</ul>
<p>BTW, <code>llm</code> helped me to come up with this solution ðŸ˜‰</p>
    </div>

<button id="openSubscribeModal" class="subscribe btn btn-secondary btn-sm">
  Subscribe
</button>

<div id="subscribeModal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-body">
        <p>
          Either use the RSS feed
          <a target="_blank" href="/blog/atom.xml">here</a>, or
          subscribe to the email newsletter.
        </p>
        <form
          action="https://app.audienceful.com/api/subscribe/5Upvrxge29AWPEBCqQ6Pj8/"
          method="post"
        >
          <div class="form-group">
            <label for="emailField">Email</label>
            <input
              name="email"
              type="email"
              class="form-control"
              id="emailField"
              aria-describedby="emailHelp"
              placeholder="name@example.com"
            />
          </div>
          <button type="submit" class="btn btn-primary">Submit</button>
          <!-- Anti spam protection -->
          <div style="position: absolute; left: -5000px" aria-hidden="true">
            <input type="text" name="b28-ft" tabindex="-1" value="" />
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button
          id="closeSubscribeModal"
          type="button"
          class="btn btn-secondary"
          data-dismiss="modal"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div></div>

<!-- Bootstrap Core JavaScript -->
<script src="/theme/js/jquery.js"></script>
<script src="/theme/js/bootstrap.min.js"></script>
<script src="/theme/js/subscribe.js"></script>    </body>
</html>